---
title: Compilare i set di dati usando oggetti TableAdapter
ms.date: 11/04/2016
ms.topic: conceptual
dev_langs:
- VB
- CSharp
helpviewer_keywords:
- datasets [Visual Basic]
- datasets [Visual Basic], loading data
- data retrieval
- retrieving data
- datasets [Visual Basic], filling
- data [Visual Studio], retrieving
- data [Visual Studio], datasets
ms.assetid: 55f3bfbe-db78-4486-add3-c62f49e6b9a0
author: ghogen
ms.author: ghogen
manager: jillfra
ms.workload:
- data-storage
ms.openlocfilehash: a79f7b781944bb93a60794e748eefb9375723384
ms.sourcegitcommit: 95f26af1da51d4c83ae78adcb7372b32364d8a2b
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 03/13/2020
ms.locfileid: "79302238"
---
# <a name="fill-datasets-by-using-tableadapters"></a>Compilare i set di dati usando oggetti TableAdapter

Un componente TableAdapter riempie un set di dati con i dati del database, in base a una o più query o stored procedure specificate. Gli oggetti TableAdapter possono inoltre eseguire aggiunte, aggiornamenti ed eliminazioni nel database per rendere persistenti le modifiche apportate al set di dati. È inoltre possibile eseguire comandi globali non correlati a una tabella specifica.

> [!NOTE]
> Gli oggetti TableAdapter vengono generati dalle finestre di progettazione di Visual Studio.TableAdapters are generated by Visual Studio designers. Se si creano dataset a livello di codice, usare DataAdapter, che è una classe .NET.

Per informazioni dettagliate sulle operazioni TableAdapter, è possibile passare direttamente a uno di questi argomenti:For detailed information about TableAdapter operations, you can skip directly to one of these topics:

|Argomento|Descrizione|
|-----------|-----------------|
|[Creare e configurare oggetti TableAdapter](../data-tools/create-and-configure-tableadapters.md)|Come utilizzare le finestre di progettazione per creare e configurare TableAdapter|
|[Creare query TableAdapter con parametri](../data-tools/create-parameterized-tableadapter-queries.md)|Come consentire agli utenti di fornire argomenti alle routine o alle query TableAdapter|
|[Accedere direttamente al database mediante un oggetto TableAdapter](../data-tools/directly-access-the-database-with-a-tableadapter.md)|Come utilizzare i metodi Dbdirect di TableAdapter|
|[Disattivare i vincoli durante il riempimento di un set di dati](../data-tools/turn-off-constraints-while-filling-a-dataset.md)|Come utilizzare i vincoli di chiave esterna durante l'aggiornamento dei datiHow to work with foreign-key constraints when updating data|
|[Come estendere la funzionalità di un TableAdapter](../data-tools/fill-datasets-by-using-tableadapters.md)|Come aggiungere codice personalizzato a TableAdapter|
|[Leggere dati XML in un set di dati](../data-tools/read-xml-data-into-a-dataset.md)|Come utilizzare XML|

<a name="tableadapter-overview"></a>

## <a name="tableadapter-overview"></a>Panoramica degli oggetti TableAdapter

Gli oggetti TableAdapter sono componenti generati dalla finestra di progettazione che si connettono a un database, eseguono query o stored procedure e riempiono il dataTable con i dati restituiti. Gli oggetti TableAdapter inviano inoltre i dati aggiornati dall'applicazione al database. È possibile eseguire tutte le query desiderate in un oggetto TableAdapter, purché restituiscano dati conformi allo schema della tabella a cui è associato il TableAdapter. Nel diagramma seguente viene illustrato come gli oggetti TableAdapter interagiscono con i database e altri oggetti in memoria:The following diagram shows how TableAdapters interact with databases and other objects in memory:

![Flusso dei dati in un'applicazione client](../data-tools/media/clientdatadiagram.gif)

Mentre gli oggetti TableAdapter sono progettati con **Progettazione DataSet**, <xref:System.Data.DataSet>le classi TableAdapter non vengono generate come classi annidate di . Si trovano in spazi dei nomi separati specifici per ogni set di dati. Se ad esempio si dispone `NorthwindDataSet`di un dataset denominato <xref:System.Data.DataTable>, gli `NorthwindDataSet` oggetti TableAdapter associati a s in saranno nello `NorthwindDataSetTableAdapters` spazio dei nomi . Per accedere a un TableAdapter specifico a livello di codice, è necessario dichiarare una nuova istanza del TableAdapter. Ad esempio:

[!code-csharp[VbRaddataTableAdapters#7](../data-tools/codesnippet/CSharp/fill-datasets-by-using-tableadapters_1.cs)]
[!code-vb[VbRaddataTableAdapters#7](../data-tools/codesnippet/VisualBasic/fill-datasets-by-using-tableadapters_1.vb)]

## <a name="associated-datatable-schema"></a>Schema DataTable associato

Quando si crea un oggetto TableAdapter, si utilizza la query iniziale o <xref:System.Data.DataTable>la stored procedure per definire lo schema dell'oggetto associato al TableAdapter. Per eseguire questa query iniziale o stored `Fill` procedure, chiamare il metodo del <xref:System.Data.DataTable>TableAdapter (che riempie l'oggetto associato al TableAdapter ). Tutte le modifiche apportate alla query principale del TableAdapter vengono riflesse nello schema della tabella dati associata. Ad esempio, la rimozione di una colonna dalla query principale rimuove anche la colonna dalla tabella dati associata. Se qualsiasi query aggiuntiva sul TableAdapter utilizzare istruzioni SQL che restituiscono colonne che non si trovano nella query principale, la finestra di progettazione tenta di sincronizzare le modifiche delle colonne tra la query principale e le query aggiuntive.

## <a name="tableadapter-update-commands"></a>Comandi di aggiornamento TableAdapterTableAdapter update commands

La funzionalità di aggiornamento di un oggetto TableAdapter dipende dalla quantità di informazioni disponibili nella query principale della **Creazione guidata TableAdapter**. Ad esempio, gli oggetti TableAdapter configurati per recuperare `JOIN`valori da più tabelle (utilizzando un oggetto ), valori scalari, viste o i risultati delle funzioni di aggregazione non vengono inizialmente creati con la possibilità di inviare aggiornamenti al database sottostante. Tuttavia, è `INSERT`possibile `UPDATE`configurare manualmente i comandi , e `DELETE` nella finestra **Proprietà.**

## <a name="tableadapter-queries"></a>TableAdapter (query)

![TableAdapter con più query](../data-tools/media/tableadapter.gif)

Gli oggetti TableAdapter possono contenere più query per riempire le tabelle dati associate. È possibile definire tutte le query per un oggetto TableAdapter richiesto dall'applicazione, purché ogni query restituisca dati conformi allo stesso schema della tabella dati associata. Questa funzionalità consente a un TableAdapter caricare risultati diversi in base a criteri diversi.

Ad esempio, se l'applicazione contiene una tabella con i nomi dei clienti, è possibile creare una query che riempie la tabella con ogni nome cliente che inizia con una determinata lettera e un'altra che riempie la tabella con tutti i clienti che si trovano nello stesso stato. Per riempire `Customers` una tabella con clienti in un `FillByState` determinato stato, è possibile creare `SELECT * FROM Customers WHERE State = @State`una query che accetta un parametro per il valore dello stato come segue: . Per eseguire la query, chiamare il `FillByState` metodo e `CustomerTableAdapter.FillByState("WA")`passare il valore del parametro in questo modo: .

Oltre ad aggiungere query che restituiscono dati dello stesso schema della tabella dati del TableAdapter, è possibile aggiungere query che restituiscono valori scalari (singoli). Ad esempio, una query che restituisce un conteggio di clienti (`SELECT Count(*) From Customers`) è valida per un `CustomersTableAdapter,` even se i dati restituiti non sono conformi allo schema della tabella.

## <a name="clearbeforefill-property"></a>ClearBeforeFill (proprietà)

Per impostazione predefinita, ogni volta che si esegue una query per riempire la tabella dati di un TableAdapter, i dati esistenti vengono cancellati e solo i risultati della query vengono caricati nella tabella. Impostare la proprietà `ClearBeforeFill` del `false` TableAdapter su se si desidera aggiungere o unire i dati restituiti da una query ai dati esistenti in una tabella dati. Indipendentemente dal fatto che si cancellino i dati, è necessario inviare in modo esplicito gli aggiornamenti al database, se si desidera rendere persistenti. Ricordarsi quindi di salvare le modifiche apportate ai dati nella tabella prima di eseguire un'altra query che riempie la tabella. Per ulteriori informazioni, vedere [Aggiornare i dati utilizzando un oggetto TableAdapter](../data-tools/update-data-by-using-a-tableadapter.md).

## <a name="tableadapter-inheritance"></a>Ereditarietà TableAdapterTableAdapter inheritance

Gli oggetti TableAdapter estendono la funzionalità degli adattatori dati standard incapsulando una classe configurata. <xref:System.Data.Common.DataAdapter> Per impostazione predefinita, il <xref:System.ComponentModel.Component> TableAdapter eredita dalla classe <xref:System.Data.Common.DataAdapter> e non può essere eseguito il cast alla classe. Il cast di <xref:System.Data.Common.DataAdapter> un oggetto <xref:System.InvalidCastException> TableAdapter alla classe genera un errore. Per modificare la classe base di un oggetto TableAdapter, <xref:System.ComponentModel.Component> è possibile specificare una classe che deriva dalla proprietà **Classe base** del TableAdapter in **Progettazione DataSet**.

## <a name="tableadapter-methods-and-properties"></a>Metodi e proprietà TableAdapter

La classe TableAdapter non è un tipo .NET. Ciò significa che non è possibile cercarlo nella documentazione o nel **Visualizzatore oggetti**. Viene creato in fase di progettazione quando si utilizza una delle procedure guidate menzionate in precedenza. Il nome assegnato a un oggetto TableAdapter al momento della creazione è basato sul nome della tabella in uso. Ad esempio, quando si crea un oggetto TableAdapter `Orders`basato su `OrdersTableAdapter`una tabella in un database denominato , il TableAdapter viene denominato . Il nome della classe del TableAdapter può essere modificato utilizzando la proprietà **Name** in **Progettazione DataSet**.

Di seguito sono riportati i metodi e le proprietà comunemente utilizzati dei TableAdapter:

|Membro|Descrizione|
|------------|-----------------|
|`TableAdapter.Fill`|Popola la tabella dati associata del TableAdapter con `SELECT` i risultati del comando del TableAdapter.|
|`TableAdapter.Update`|Restituisce le modifiche al database e restituisce un numero intero che rappresenta il numero di righe interessate dall'aggiornamento. Per ulteriori informazioni, vedere [Aggiornare i dati utilizzando un oggetto TableAdapter](../data-tools/update-data-by-using-a-tableadapter.md).|
|`TableAdapter.GetData`|Restituisce <xref:System.Data.DataTable> un nuovo file pieno di dati.|
|`TableAdapter.Insert`|Crea una nuova riga nella tabella dati. Per ulteriori informazioni, consultate [Inserire nuovi record in un database.](../data-tools/insert-new-records-into-a-database.md)|
|`TableAdapter.ClearBeforeFill`|Determina se una tabella dati viene svuotata prima di chiamare uno dei `Fill` metodi.|

## <a name="tableadapter-update-method"></a>Metodo di aggiornamento TableAdapter

Gli oggetti TableAdapter utilizzano i comandi dati per leggere e scrivere dal database. Utilizzare la query `Fill` iniziale (principale) del TableAdapter come base per la creazione `InsertCommand`dello `UpdateCommand`schema `DeleteCommand` della tabella dati `TableAdapter.Update` associata, nonché i comandi , e associati al metodo. La chiamata al `Update` metodo di un TableAdapter esegue le istruzioni create quando il TableAdapter è stato configurato in origine, non una delle query aggiuntive aggiunte con la Configurazione guidata query **TableAdapter**.

Quando si utilizza un TableAdapter, esegue in modo efficace le stesse operazioni con i comandi che si eseguano in genere. Ad esempio, quando si chiama `Fill` il metodo dell'adattatore, `SelectCommand` l'adattatore esegue il <xref:System.Data.SqlClient.SqlDataReader>comando dati nella relativa proprietà e utilizza un lettore dati (ad esempio, ) per caricare il set di risultati nella tabella dati. Analogamente, quando si chiama `Update` il metodo dell'adattatore, `UpdateCommand` `InsertCommand`viene `DeleteCommand` eseguito il comando appropriato (nelle proprietà , e ) per ogni record modificato nella tabella dati.

> [!NOTE]
> Se nella query principale sono presenti `InsertCommand` `UpdateCommand`informazioni `DeleteCommand` sufficienti, i comandi , e vengono creati per impostazione predefinita quando viene generato il TableAdapter . Se la query principale del TableAdapter è `SELECT` più di una singola istruzione di tabella, `InsertCommand` `UpdateCommand`è `DeleteCommand`possibile che la finestra di progettazione non sia in grado di generare , , e . Se questi comandi non vengono generati, è possibile `TableAdapter.Update` che venga visualizzato un errore durante l'esecuzione del metodo.

## <a name="tableadapter-generatedbdirectmethods"></a>TableAdapter GenerateDbDirectMethods

Oltre a `InsertCommand` `UpdateCommand`, `DeleteCommand`e , gli oggetti TableAdapter vengono creati con metodi che è possibile eseguire direttamente sul database. È possibile chiamare`TableAdapter.Insert`direttamente `TableAdapter.Update`questi `TableAdapter.Delete`metodi ( , e ) per modificare i dati nel database. Ciò significa che è possibile chiamare questi `TableAdapter.Update` singoli metodi dal codice anziché chiamare per gestire gli inserimenti, gli aggiornamenti e le eliminazioni in sospeso per la tabella dati associata.

Se non si desidera creare questi metodi diretti, impostare il TableAdapter `false` **GenerateDbDirectMethods** proprietà (nella finestra **Proprietà).** Le query aggiuntive aggiunte al TableAdapter sono query autonome, ovvero non generano questi metodi.

## <a name="tableadapter-support-for-nullable-types"></a>Supporto TableAdapter per i tipi nullableTableAdapter support for nullable types

Gli oggetti TableAdapter `Nullable(Of T)` supportano tipi nullable e `T?`. Per altre informazioni sui tipi nullable in Visual Basic, vedere [Tipi di valori Nullable](/dotnet/visual-basic/programming-guide/language-features/data-types/nullable-value-types). Per ulteriori informazioni sui tipi che possono essere nullable in C, vedere [Usare i tipi nullable.](/dotnet/csharp/programming-guide/nullable-types/using-nullable-types)

<a name="tableadaptermanager-reference"></a>

## <a name="tableadaptermanager-reference"></a>Riferimento a TableAdapterManagerTableAdapterManager reference

Per impostazione predefinita, una classe TableAdapterManager viene generata quando si crea un dataset contenente tabelle correlate. Per impedire la generazione della classe, `Hierarchical Update` modificare il valore della proprietà del dataset su false. Quando si trascina una tabella con una relazione nell'area di progettazione di una pagina Windows Form o WPF, Visual Studio dichiara una variabile membro della classe. Se non si utilizza l'associazione dati, è necessario dichiarare manualmente la variabile.

La classe TableAdapterManager non è un tipo .NET. Pertanto, non è possibile cercare nella documentazione. Viene creato in fase di progettazione come parte del processo di creazione del set di dati.

Di seguito sono riportati i `TableAdapterManager` metodi e le proprietà utilizzati di frequente della classe:

|Membro|Descrizione|
|------------|-----------------|
|Metodo `UpdateAll`|Salva tutti i dati da tutte le tabelle dati.|
|Proprietà `BackUpDataSetBeforeUpdate`|Determina se creare una copia di backup `TableAdapterManager.UpdateAll` del set di dati prima di eseguire il metodo. Boolean.|
|*tableName (proprietà)* `TableAdapter`|Rappresenta un TableAdapter. Il TableAdapterManager generato contiene `TableAdapter` una proprietà per ognuno che gestisce. Ad esempio, un dataset con un Customers e Orders `CustomersTableAdapter` tabella `OrdersTableAdapter` genera con un TableAdapterManager che contiene e proprietà.|
|Proprietà `UpdateOrder`|Controlla l'ordine dei singoli comandi di inserimento, aggiornamento ed eliminazione. Impostare questo valore su `TableAdapterManager.UpdateOrderOption` uno dei valori dell'enumerazione.<br /><br /> Per impostazione `UpdateOrder` predefinita, l'oggetto è impostato su **InsertUpdateDelete**. Ciò significa che gli inserimenti, gli aggiornamenti e quindi le eliminazioni vengono eseguiti per tutte le tabelle nel set di dati.|

## <a name="security"></a>Security

Quando si utilizzano comandi dati con <xref:System.Data.CommandType.Text>una proprietà CommandType impostata su , controllare attentamente le informazioni inviate da un client prima di passarle al database. Qualche utente malintenzionato potrebbe tentare di inviare (inserire) istruzioni SQL modificate o aggiuntive, allo scopo di ottenere un accesso non autorizzato o di danneggiare il database. Prima di trasferire l'input dell'utente in un database, verificare sempre che le informazioni siano valide. È consigliabile utilizzare sempre query con parametri o stored procedure quando possibile.

## <a name="see-also"></a>Vedere anche

- [Strumenti per i set di dati](../data-tools/dataset-tools-in-visual-studio.md)
