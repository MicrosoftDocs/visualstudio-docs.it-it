---
title: 'CA3007: Esaminare il codice per verificare la presenza di vulnerabilità di tipo reindirizzamento aperto'
ms.date: 04/03/2019
ms.topic: reference
author: dotpaul
ms.author: paulming
manager: jillfra
dev_langs:
- CSharp
- VB
ms.workload:
- multiple
ms.openlocfilehash: 5bfddd5af56203fd053903f8c4fc157dbf159182
ms.sourcegitcommit: b885f26e015d03eafe7c885040644a52bb071fae
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 06/30/2020
ms.locfileid: "85523058"
---
# <a name="ca3007-review-code-for-open-redirect-vulnerabilities"></a>CA3007: Esaminare il codice per verificare la presenza di vulnerabilità di tipo reindirizzamento aperto

|Elemento|valore|
|-|-|
|CheckId|CA3007|
|Category|Microsoft.Security|
|Modifica|Senza interruzioni|

## <a name="cause"></a>Causa

Un input di richiesta HTTP potenzialmente non attendibile raggiunge un reindirizzamento di risposta HTTP.

Per impostazione predefinita, questa regola analizza l'intera codebase, ma può essere [configurata](#configurability).

## <a name="rule-description"></a>Descrizione della regola

Quando si lavora con un input non attendibile, tenere presenti le vulnerabilità di reindirizzamento aperte. Un utente malintenzionato può sfruttare una vulnerabilità di reindirizzamento aperto per usare il sito Web per dare l'impressione di un URL legittimo, ma reindirizzare un visitatore ignaro a un phishing o ad altre pagine Web dannose.

Questa regola tenta di trovare l'input da richieste HTTP che raggiungono un URL di reindirizzamento HTTP.

> [!NOTE]
> Questa regola non è in grado di rilevare i dati tra gli assembly. Se, ad esempio, un assembly legge l'input della richiesta HTTP e lo passa a un altro assembly che risponde con un reindirizzamento HTTP, questa regola non genera un avviso.

> [!NOTE]
> Esiste un limite configurabile per il livello di profondità con cui questa regola analizzerà il flusso di dati tra le chiamate al metodo. Per informazioni su come configurare il limite in un file EditorConfig, vedere la pagina relativa alla [configurazione dell'analizzatore](https://github.com/dotnet/roslyn-analyzers/blob/master/docs/Analyzer%20Configuration.md#dataflow-analysis) .

## <a name="how-to-fix-violations"></a>Come correggere le violazioni

Alcuni approcci alla correzione di vulnerabilità di reindirizzamento aperte includono:

- Non consentire agli utenti di avviare i reindirizzamenti.
- Non consentire agli utenti di specificare alcuna parte dell'URL in uno scenario di reindirizzamento.
- Limitare i reindirizzamenti a un "elenco Consenti" predefinito di URL.
- Convalida URL di reindirizzamento.
- Se applicabile, prendere in considerazione l'uso di una pagina di dichiarazione di non responsabilità quando gli utenti vengono reindirizzati fuori dal sito.

## <a name="when-to-suppress-warnings"></a>Quando escludere gli avvisi

Se si è certi di aver convalidato l'input in modo che sia limitato agli URL desiderati, è possibile evitare di visualizzare questo avviso.

## <a name="configurability"></a>Configurabilità

Se si esegue questa regola da [analizzatori FxCop](install-fxcop-analyzers.md) (e non con analisi legacy), è possibile configurare l'analisi per questa regola.

### <a name="excluded-symbol-names"></a>Nomi di simboli esclusi

È possibile configurare le parti della codebase da escludere dall'analisi. Ad esempio, per specificare che la regola non deve essere eseguita in alcun codice all'interno di tipi denominati `MyType` , aggiungere la coppia chiave-valore seguente a un file con estensione EditorConfig nel progetto:

```ini
dotnet_code_quality.CA3007.excluded_symbol_names = MyType
```

Formati dei nomi di simboli consentiti nel valore dell'opzione (separati da' |'):
  - Solo nome simbolo (include tutti i simboli con il nome, indipendentemente dal tipo o dallo spazio dei nomi che lo contiene)
  - Nomi completi nel [formato ID documentazione](https://github.com/dotnet/csharplang/blob/master/spec/documentation-comments.md#id-string-format)del simbolo. Ogni nome di simbolo richiede un prefisso di tipo simbolo, ad esempio il prefisso "M:" per i metodi, il prefisso "T:" per i tipi, il prefisso "N:" per gli spazi dei nomi e così via.
  - `.ctor`per costruttori e `.cctor` per costruttori statici

Esempi:

| Valore dell'opzione | Summary |
| --- | --- |
|`dotnet_code_quality.CA3007.excluded_symbol_names = MyType` | Corrisponde a tutti i simboli denominati ' MyType ' nella compilazione
|`dotnet_code_quality.CA3007.excluded_symbol_names = MyType1|MyType2` | Corrisponde a tutti i simboli denominati ' MyType1' o ' MyType2' nella compilazione
|`dotnet_code_quality.CA3007.excluded_symbol_names = M:NS.MyType.MyMethod(ParamType)` | Corrisponde al metodo specifico ' MyMethod ' con la firma completa specificata
|`dotnet_code_quality.CA3007.excluded_symbol_names = M:NS1.MyType1.MyMethod1(ParamType)|M:NS2.MyType2.MyMethod2(ParamType)` | Corrisponde ai metodi specifici ' MyMethod1' è MyMethod2' con la rispettiva firma completa

È possibile configurare tutte queste opzioni solo per questa regola, per tutte le regole o per tutte le regole in questa categoria (sicurezza). Per altre informazioni, vedere [configurare gli analizzatori FxCop](configure-fxcop-analyzers.md).

## <a name="pseudo-code-examples"></a>Esempi di pseudo-codice

### <a name="violation"></a>Violazione

```csharp
using System;

public partial class WebForm : System.Web.UI.Page
{
    protected void Page_Load(object sender, EventArgs e)
    {
        string input = Request.Form["url"];
        this.Response.Redirect(input);
    }
}
```

```vb
Imports System

Partial Public Class WebForm
    Inherits System.Web.UI.Page

    Protected Sub Page_Load(sender As Object, eventArgs As EventArgs)
        Dim input As String = Me.Request.Form("url")
        Me.Response.Redirect(input)
    End Sub
End Class
```

### <a name="solution"></a>Soluzione

```csharp
using System;

public partial class WebForm : System.Web.UI.Page
{
    protected void Page_Load(object sender, EventArgs e)
    {
        string input = Request.Form["in"];
        if (String.IsNullOrWhiteSpace(input))
        {
            this.Response.Redirect("https://example.org/login.html");
        }
    }
}
```

```vb
Imports System

Partial Public Class WebForm
    Inherits System.Web.UI.Page

    Protected Sub Page_Load(sender As Object, eventArgs As EventArgs)
        Dim input As String = Me.Request.Form("in")
        If String.IsNullOrWhiteSpace(input) Then
            Me.Response.Redirect("https://example.org/login.html")
        End If
    End Sub
End Class
```
